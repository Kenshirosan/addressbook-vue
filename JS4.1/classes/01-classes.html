<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
        />
        <link
            rel="stylesheet"
            href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/dark.min.css"
        />
        <link rel="stylesheet" href="../css/style.css" />
        <title>Les classes en JavaScript</title>
    </head>
    <body>
        <header>
            <h1>Les classes en JavaScript</h1>
        </header>
        <div class="container">
            <article>
                <h3>La syntaxe:</h3>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 --> //
<!--                -->}
    <!--         --></code><!--
            --></pre>
                <!--
                -->
                <h3>A quoi sert une classe ?</h3>
                <p>
                    Une classe permet de grouper au même endroit des morceaux de
                    codes qui gèrent le même type de problèmes.
                </p>
                <p>
                    Une classe
                    <strong
                        ><em
                            >ne doit faire qu'une seule chose, elle n'a qu'une
                            responsabilité
                        </em> </strong
                    >, ici on prendra comme exemple la gestion d'erreur.
                </p>
                <p>
                    Dans notre domaine, nous devons en permanence gérer la
                    validité des formulaires
                </p>
                <p>
                    Pour cela, nous pouvons créer une classe qui ne gèrera que
                    les erreurs et ajouter toutes les fonctions qui gèrent les
                    erreurs dans cette classe.
                </p>
                <p>
                    Quand on ajoute un fonction dans une classe, on ne l'appelle
                    plus fonction mais <strong><em>méthode</em></strong
                    >.
                </p>
                <p>
                    Voici la syntaxe pour ajouter une
                    <strong><em>méthode </em></strong>dans une classe.
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 -->    recordErrors() {
    <!--                 -->    //
    <!--                 -->}
<!--                -->}
    <!--         --></code><!--
             --></pre>
                <!--
                -->
                <p>
                    Tout comme pour une fonction 'normale', notre
                    <strong><em>méthode </em></strong> peut accepter des
                    arguments, et faire un travail avec.
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 -->    recordErrors(errors) {
    <!--                 -->    this.errors = errors;
    <!--                 -->}
<!--                -->}
    <!--         --></code><!--
             --></pre>
                <!--
                -->
                <p>
                    Pour comprendre ce morceau de code, quelques explications
                    sont nécessaires:
                </p>
                <h3>Le mot-clé:</h3>
                <pre><code class="hljs js">this</code></pre>
                <p>
                    Le mot-clé: <strong><em>this</em></strong> représente
                    simplement l'objet ou instance issue de la classe.
                </p>
                <p>Ainsi</p>
                <pre><code class="hljs js">this.errors</code></pre>
                <p>
                    signifie qu'on veut accéder à une variable
                    <strong><em>errors </em></strong>de notre classe, qu'on
                    appelle une variable membre. Grâce à ce mot-clé, on peut
                    aussi appeler les méthodes de la classe.
                </p>
                <p>
                    Pour l'instant la classe ne sait pas qu'elle a une variable
                    <strong><em>errors</em></strong
                    >. Pour la déclarer, il nous faut un constructeur:
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 -->    constructor() {
<!--                 -->        this.errors = {};
<!--                 -->    }
<!--                 -->
<!--                 -->    recordErrors(errors) {
    <!--                 -->    this.errors = errors;
    <!--                 -->}
<!--                -->}
    <!--         --></code><!--
             --></pre>
                <p>
                    Un constructeur <strong><em>constructor()</em></strong> est
                    une méthode qui est appelé automatiquement quand on crée un
                    objet issue d'une classe.
                </p>
                <p>
                    Quand on crée un objet à partir d'une classe, on parle
                    d'instanciation. Dans cet exemple, on initialise la variable
                    errors
                    <strong><em>avec pour valeur un objet vide</em></strong
                    >.
                </p>
                <p>Pour instancier une classe, voici la syntaxe:</p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->const errors = new CustomErrors();<!--
             --></code><!--
             --></pre>
                <p>
                    On a maintenant une instance de la classe CustomErrors et on
                    peut accéder à ses méthodes.
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->const errors = new CustomErrors();
<!--                 -->//On a instancie la classe CustomErrors, on sait que sa propriété errors est un objet vide.
<!--                 -->//On sait que la méthode recordError accepte un argument et que cette argument est un objet.
<!--                 -->const errors = { error: "invalidField", message: `Le champ ${input.name} n'est pas valide` }
<!--                 -->errors.recordErrors(error);
<!--             --></code><!--
             --></pre>
                <p>
                    On a donc enregistré une erreur. Maintenant, on doit pouvoir
                    y accéder. Il suffit de rajouter un méthode qui nous le
                    permet:
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 -->    constructor() {
<!--                 -->        this.errors = {};
<!--                 -->    }
<!--                 -->
<!--                 -->    recordErrors(errors) {
<!--                 -->        this.errors = errors;
<!--                 -->    }
<!--                 -->
<!--                 -->    getErrors() {
<!--                 -->        console.log(this.errors);
<!--                 -->    }
<!--                -->}
<!--             --></code><!--
             --></pre>
                <p>
                    Pour accéder aux données, il ne reste qu'appeler la méthode
                    <code>getErrors()</code>:
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->const errors = new CustomErrors();
<!--                 -->// On a instancié la classe, on sait que sa propriété errors est un objet vide.
<!--                 -->// On sait que la méthode recordError accepte un argument. Ce sera un objet.
<!--                 -->const errors = { error: "unknown", message: "same player play again" }
<!--                 -->error.recordErrors(error);
<!--                 -->
<!--                 -->errors.getErrors();
<!--             --></code><!--
             --></pre>
                <p>
                    Vous pouvez maintenant appuyer sur <code>f12</code> et voir
                    le résultat.
                </p>
                <p>
                    On a créer la classe CustomErrors dans le fichier
                    correspondant CustomErrors.js, c'est une convention de
                    nommer le fichier et la classe exactement de la même
                    manière, on s'y retrouve beaucoup plus facilement.
                </p>
                <p>
                    <strong>
                        L'organisation du code est aussi importante que le code
                        lui même, on doit tout faire pour qu'il soit le plus
                        lisible et le mieux organisé possible.
                    </strong>
                </p>
                <p>
                    Dans cet exemple, on a la classe CustomErrors et après la
                    déclaration de celle-ci, on l'exporte ainsi:
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->class CustomErrors {
<!--                 -->    constructor() {
<!--                 -->        this.errors = {};
<!--                 -->    }
<!--                 -->
<!--                 -->    recordErrors(errors) {
<!--                 -->        this.errors = errors;
<!--                 -->    }
<!--                 -->
<!--                 -->    getErrors() {
<!--                 -->        console.log(this.errors);
<!--                 -->    }
<!--                -->}
<!--                -->
<!--                -->export default CustomErrors;
<!--             --></code><!--
             --></pre>
                <p>
                    <code>export default CustomErrors</code> nous permet
                    d'exporter ce qu'on appelle un module.
                </p>
                <p>
                    Naturellement, si on exporte un fichier, on va l'importer
                    ailleurs.
                </p>
                <pre><!--
                 --><code class="hljs js"><!--
                     -->import CustomErrors from './modules/CustomErrors.js';
<!--             --></code><!--
             --></pre>
                <p>
                    Dans le fichier class.js, on importe la classe et on s'en
                    sert dans la fonction <code>validateFormInput()</code> ainsi
                    que dans le test en dessous.
                </p>
                <pre>
<!--            ---><code>
<!--            --->import CustomErrors from './modules/CustomErrors.js';
<!--            --->
<!--            --->//Instanciation
<!--            --->const errors = new CustomErrors();
<!--            --->
<!--            --->function validateFormInput(input) {
<!--            --->    if (!input.value) {
<!--            --->        return errors.recordErrors({ // la méthode de la classe CustomErrors
<!--            --->            error: 'unknown',
<!--            --->            message: 'Same player play again',
<!--            --->        });
<!--            --->    }
<!--            --->
<!--            --->    return input.value;
<!--            --->}
<!--            --->
<!--            --->if (!validateFormInput(`un input invalide`)) {
<!--            --->    errors.getErrors(); // l'autre méthode.
<!--            --->}
<!--            ---></code>
                </pre>
                <p>
                    Pour rendre possible l'import / export de modules, on doit
                    le spécifier dans la balise script du fichier html.
                </p>
                <pre><!--
                 --><code class="hljs html"><!--
                     -->&lt;script type="module" src="class.js"&gt&lt;/script&gt;
<!--             --></code><!--
             --></pre>
                <p>
                    Attention: il est facile d'oublier cet attribut:
                    <code>type="module"</code>
                </p>
                <p>
                    Lisez le code et
                    <strong
                        ><em>n'hésitez pas à poser des questions</em></strong
                    >
                    à votre formateur.
                </p>
                <p>
                    Il existe plusieurs façons d'exporter / importer des
                    modules, nous verrons ces cas plus tard.
                </p>
            </article>
        </div>

        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
        <script>
            hljs.initHighlightingOnLoad();
        </script>
        <script type="module" src="js/class.js"></script>
    </body>
</html>
